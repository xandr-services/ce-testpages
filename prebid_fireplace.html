<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>MPX Fireplace Testpage - Prebid version</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300|ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!--<script async src="//acdn.adnxs.com/prebid/not-for-prod/1/prebid.js"></script> -->
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/prebid.js@latest/dist/not-for-prod/prebid.js" async></script>
    <script type="text/javascript" src="//acdn.adnxs.com/ast/ast.js" async></script>
      
    <style media="screen">
        body {
          background: #eaf6f6;
         }

         p {
           padding: 1em;
         }

        .container {
          display: grid;
          grid-template-columns: 1fr 728px 1fr;
          grid-template-rows: auto 0.8fr 0.5fr 0.5fr 0.5fr;
          gap: 0px 0px;
          grid-auto-flow: row;
          grid-template-areas:
            "left_sky superbanner right_sky"
            "left_sky content right_sky"
            "left_sky content right_sky"
            "left_sky content right_sky"
            "left_sky content right_sky";
        }

        .superbanner { grid-area: superbanner; }

        .left_sky { grid-area: left_sky; justify-items: end; justify-content: end; }

        .right_sky { grid-area: right_sky; }

        .content { grid-area: content; background: #fcfefe; color: #2f3033; margin-top: -6px; }


    </style>
    <script>
    	function removeHTMLComment(str){
      	return str.replace("<!--", "").replace("-->", "");
      }

      function getCompanionAdsById(dom, id){
        let compDomElem = dom.getElementById(id);
        let admComment = compDomElem.innerHTML;
        let adm = removeHTMLComment(admComment);
        return adm;
      }


      function waitForElm(dom, selector) {
          return new Promise(resolve => {
              if (dom.querySelector(selector)) {
                  return resolve(dom.querySelector(selector));
              }

              const observer = new MutationObserver(mutations => {
                  if (dom.querySelector(selector)) {
                      resolve(dom.querySelector(selector));
                      observer.disconnect();
                  }
              });

              observer.observe(dom, {
                  childList: true,
                  subtree: true,
                  attributes: true,
                  characterData: true
              });
          });
      }

      function renderFireplaceCompanion(dom, elm, target) {
        try {
          let adm = getCompanionAdsById(dom, elm);
          document.getElementById(target).innerHTML = adm;
        } catch(error){
        }
      }

    </script> 

     <script>
        let adUnits = [];

        let adUnit =
        {
            code: "right_sky",
            mediaTypes: {
                banner: {
                  sizes: [[300,100],[300,250],[300,600],[301,601]]
                }
            },
            bids: [
            {
                bidder:"appnexus",
                params:
                {
                    invCode:'Fireplace_Sky_Right_MPX',
                    member: 958
                }
            }]
        };
        
        var PREBID_TIMEOUT = 1000;

        adUnits.push(adUnit);
        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];

            
        pbjs.que.push(function() {
            pbjs.setConfig({
                debug: true
            });
            pbjs.addAdUnits(adUnits);
            pbjs.requestBids({
                bidsBackHandler: function(bidResponses) {
                    initAdserver();
                },
                timeout: PREBID_TIMEOUT
            });

           /*
            pbjs.addAdUnits(adUnits);
            pbjs.requestBids({
                bidsBackHandler: function (bidResponses) {
                var winningBids = [];

                let ad = pbjs.getHighestCpmBids("right_sky");

                if (ad && ad.length > 0) {
                    let idIFrame = "right_skyframe";

                    let iFrame = "<iframe id='" + idIFrame + "'"
                    + " FRAMEBORDER=\"0\""
                    + " SCROLLING=\"no\""
                    + " MARGINHEIGHT=\"0\""
                    + " MARGINWIDTH=\"0\""
                    + " TOPMARGIN=\"0\""
                    + " LEFTMARGIN=\"0\""
                    + " ALLOWTRANSPARENCY=\"true\""
                    + " WIDTH=\"0\""
                    + " HEIGHT=\"0\">."
                    + " </iframe>"

                    document.getElementById("right_sky").innerHTML += iFrame;

                    var iframe = document.getElementById(idIFrame);
                    var iframeDoc = iframe.contentWindow.document;

                    try {
                        pbjs.renderAd(iframeDoc, ad[0]['adId']);
                    } catch (e) {
                        console.log(e);
                    }

                    winningBids = pbjs.getAllWinningBids();
                    console.log(winningBids);
                } 
                else 
                {
                  console.log("No bids");
                };
            },
                timeout: 2000
            });   */
        });
        </script>
      
      <script type="text/javascript">
          
      
      var apntag = apntag || {};
      apntag.anq = apntag.anq || [];

      (function() {
         var d = document, e = d.createElement('script'), p = d.getElementsByTagName('head')[0];
         e.type = 'text/javascript';  e.async = true;
         e.src = '//acdn.adnxs.com/ast/ast.js';
         p.insertBefore(e, p.firstChild);
      })();
        /*  
     apntag.anq.push(function() {
        apntag.setPageOpts({
            member: 958,
            disablePsa: false,
            targetingParams: {}
        });
        apntag.defineTag({
            tagId: 18388951,
            sizes: [[300,250], [301,601]],
            targetId: 'right_sky',
            allowedFormats: [ 'banner'],
            keywords: {
                'key': ['value']
              }
        });
    }); */

            //start loading tags
          
          //const delay = ms => new Promise(res => setTimeout(res, ms)); //function to delay the adserver call
          
            function initAdserver() {
                //await delay(1000); //wait 2 seconds
                if (pbjs.requestSent) {
                    return;
                }
                pbjs.requestSent = true;
                console.log('1');
                pbjs.que.push(function() {
                    apntag.anq.push(function() {
                        apntag.setPageOpts({
                            member: 958,
                            disablePsa: false,
                            targetingParams: {}
                        });
                        apntag.defineTag({
                            tagId: 15712318,
                            sizes: [[300,250], [301,601]],
                            targetId: 'right_sky',
                            allowedFormats: [ 'banner'],
                            keywords: {
                                'key': ['value']
                              }
                        });
                        console.log('2');
                        pbjs.setTargetingForAst();
                        apntag.loadTags();
                        console.log('3');
                    });
                });
            }

      </script>
      
    </head>


  <body>
    <div class="container">
    <div class="adslot superbanner"> <div id="superbanner"></div> </div>
    <div class="adslot left_sky"> <div id="left_sky"></div> </div>
    <div class="adslot right_sky"> 
        <div id="right_sky">
        </div>
    </div>
    <div class="div4 content">
      <div class="jumbotron" style="background: #113f67; color: #e7eaf6; border-radius: 0;">
        <h2>MPX Fireplace Test Page with Prebid.js</h2>
        <p>For demonstration purposes only.</p>
         <button onclick="apntag.showTag('right_sky');">ShowTag (Fireplace)</button>
      </div>
      <div class="container-fluid">
        <div class="row">
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
    </div>
    </div>
    </div>
 </body>
</html>
